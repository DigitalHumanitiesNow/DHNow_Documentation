JDH EPub Instructions
Software Needed: Calibre


General Steps:
1. Creating a empty (or new) Book for each article and adding appropriate metadata. 
2. Formatting each Book within Calibre’s editor
3. Saving and Exporting the epub
4. Merging all the books into one anthology and final edits
5. Export to epub, mobi, and pdf.


Add an Empty Book
1. Create one book for each article in issue by selecting “Add empty book” from the calibre “Add Books” dropdown.  
2. In the options box add the author of the article to the author field and click “ok”.
3. In the library click on the title to edit and add the title of the article to the new book. 
4. Additional meta data can be added by right clicking and selecting “Edit Metadata”.


Editing and Formatting the Article in Calibre
An epub is essentially a zipped folder with directories of text (html &xml files), stylesheets (.css files), and images that together makeup the epub.  
Once in the edit screen within Calibre: 
1. Create a new file.   Screen Shot 2014-07-09 at 1.48.54 PM.png 
   * When creating a file in calibre you need to tell it what folder to put that item in.  Text files (the html of the article) need to be stores in the text directory and stylesheets in the styles directory.  When creating the file name it like this: 
text/authorlastname.html
   * this adds a file called “atuhorlastname.html” into the text folder within the epub


   1. Add the text of the article: 
   * View the JDH article in wordpress and view the source of the file in the browser.  From the html select the post content starting with the title (usually an h1) and ending just before the author bio information.  
   * Copy this text and paste it into the calibre html file between the <body> tags.


   1. Link the JDH Stylesheet
   * create a new stylesheet in the calibre editor The filename should be “styles/authorlastname_style.css”.  This creates a file called authorlastnamestyle.css in the styles folder within the epub.
   * Link the stylesheet to the html document.  Place this code into the <head> section of the html document:
 <link rel="stylesheet" type="text/css" href="../styles/authorlastname_style.css"/>
   * The stylesheet can be found on basecamp.
   1. Add Images
   * Once the html is added to calibre the images will likely show up.  However, in order for the images to export to all portable devices we have to add the images in and link them locally rather than externally.  
   * To add images into calibre first save the images from the wordpress article.  
   * Under ‘File’ in calibre select “Import files into book” and find the local files.  Use shift or command to select more than one file.  Calibre will add the images into the main directory of the epub. 
   * The html pulled from wordpress included references to the images but needs to be changed slightly to remove sizing and replace external links with internal links.  
   * The wordpress code looks like this: 


<div id="attachment_3485" style="width: 472px" class="wp-caption aligncenter"><a href="http://www.literaturegeek.com/wp-content/uploads/2014/04/IUsimplecycle.jpg" ><img class="size-full wp-image-3485" src="http://www.literaturegeek.com/wp-content/uploads/2014/04/IUsimplecycle.jpg" alt="The site lets readers add notes and otherwise discuss the text, then uses those notes to make a more customized experience for each reader." width="462" height="508" /></a><p class="wp-caption-text">The site lets readers add notes and otherwise discuss the text, then uses those notes to make a more customized experience for each reader.</p></div>
	

   * Make the following changes to the code (for each image in the article): 
   1. delete style=”width: xxx px”
   2. replace the url in the img tag with the path to the image you added to calibre.  It should be “../imagename.jpg” (or .png  the file name must be exactly the same as the original file that was imported into calibre).
   3. delete the width and height from the image tag.  
   * The new code should look like this:


<div id="attachment_3485" class="wp-caption aligncenter"><a href="http://www.literaturegeek.com/wp-content/uploads/2014/04/IUsimplecycle.jpg" ><img class="size-full wp-image-3485" src="../viconti1.jpg" alt="The site lets readers add notes and otherwise discuss the text, then uses those notes to make a more customized experience for each reader." width="462" height="508" /></a><p class="wp-caption-text">The site lets readers add notes and otherwise discuss the text, then uses those notes to make a more customized experience for each reader.</p></div>
	   1. A preview of the epub appears in the window on the right.  
   2. When finished editing save and exit the editor.  To preview the epub right click on the book in the calibre library and under view select ‘View Specific format’.  From here you can select epub or mobi and preview it.  
   3. When the book is finished and ready for merging and conversion select the book in the library and choose “Save to disk in a specific directory” from the “Save to Disk” menu.


Merging Individual Articles into One Anthology
   * To merge the files into one anthology you must have the Epub Merge plugin installed.  
   * To install: 
   * Open the Preferences menu
   * Select Plugins
   * Search for Epub Merge and select “enable plugin”
   * To Merge individual articles into one epub: 
   * Select all of the articles that need to be included in the merged version
   * Right click and select Epub Merge and then merge epubs
   * In the dialog box move the articles into the correct order 
   * Review the metadata and make any necessary changes 
   * Click ‘Ok’ and Calibre will merge all of the files into a new epub.  The merged version will show up in the library.
File structure of the merged Anthology
   * Each article in the anthology gets placed into its own folder within the epub and is numbered.  
   * Inside of each individual folder for an article is:
   * a text folder--holds the text of the article
   * a styles folder -- holds the original style sheet
   * start.xhtml file which is a title sheet that appears prior to the article and is what the table of contents links to.
   * a metadata file that contains the metadata for the individual article.  
Editing the Merged Anthology
   * Several changes need to be made to the final Epub once it has been merged.  
   1. Generate a Table of Contents
   * In the edit screen, select tools → table of contents → edit table of contents
   * Make sure all the information is correct and the articles are in the correct order.  Calibre will automatically add a new entry for each file included in the merge.  
   * Click ‘ok’
   * Select tools → table of contents → insert inline table of contents. This will create a new file called toc.xhtml 
   * Link one of the stylesheets to the toc.xhtml file so that the styles match the rest of the book. Right click on the toc.xhtml file and select link style sheets from the options menu & select a file to link.
   1. Add appropriate info to the Start.xhtml file (the cover sheet before each article).  
   * Add the title of the article to both the <title> tag in the <head> and the <h1> in the body.  
   * From the wordpress site insert the section of code that displays the author bio. It should be the code in the <div class="author-bio"> section.
   * Delete link and other code inside of the <div class=”gravatar>
   * The final code should look something like this: 


<div class="author-bio">
    <h2>About Noah Wardrip-Fruin</h2>
<p class="coauthor">Noah Wardrip-Fruin is Associate Professor of Computer Science and co-director of the Expressive Intelligence Studio at UC Santa Cruz. His books include The New Media Reader (MIT Press, 2003) and Expressive Processing (MIT Press, 2009). Recent projects include Prom Week (2012 finalist at IndieCade and the Independent Games Festival) and the 2014 report of the Media Systems project: "Envisioning the Future of Computational Media" (a project supported by the NSF, NEH, NEA, Microsoft Studios, and Microsoft Research). He holds an MFA and PhD from Brown University, an MA from New York University, and a BA from the Johnston Center at the University of Redlands.</p>    
</div>


	

Exporting the Issue to Final Formats and Saving to Disk
   * To convert the final epub file: 
   1. Right click on finished file in library
   2. select convert files → convert individually
   * PDF
   1. set the output format (top right of dialog box) to ‘PDF’
   2. Change the following options: 
   * Metadata tab → add the cover image and make any final adjustments to the metadata.
   * Page setup tab → margins should be 65 pts on each side
   * Table of contents tab → check do not add detected chapter to the Table of Contents (we defined the table of contents already)
   * PDF Output tab: 
   * Check Override paper size set in output profile → paper size should be letter
   * Check add page numbers to the bottom of every page
   * Change the default and monospace font size to 12px. 
   * Add to the footer template: 
   * Mobi
   1. set the output format (top right of dialog box) to ‘PDF’
   2. Change the following options: 
   * Metadata tab → add the cover image and make any final adjustments to the metadata.
   * Table of contents tab → check do not add detected chapter to the Table of Contents (we defined the table of contents already)
   * Mobi Output tab: 
   * check Do not add table of contents to book
   * under Kindle options set the MOBI file type to ‘both’.
   * To save the final files to disk (for posting on the web): 
   1. Select the file in the library and select ‘Save to Disk’ → ‘Save to disk’
   2. Select a directory to save the files to.  
   3. Calibre will export a folder with all of the converted files.